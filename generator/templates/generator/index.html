{% load static %}

<!DOCTYPE html>

<html lang="en">

<head>

  <meta charset="UTF-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <meta name="csrf-token" content="{{ csrf_token }}">

  <title>AI Prompt Generator for Educators</title>

  <script src="https://cdn.tailwindcss.com"></script>

  <script src="https://cdn.jsdelivr.net/npm/daisyui@latest"></script>

  <script>

    tailwind.config = {

      daisyui: {

        themes: ["dark"]

      }

    }

  </script>

</head>

<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">

  

  <div class="max-w-4xl mx-auto px-4 py-8">

    <div class="bg-white rounded-2xl shadow-xl p-8">

      <div class="bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-700 text-white py-8 mb-8 rounded-xl shadow-lg">

  <div class="bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl shadow-lg px-6 py-10 sm:px-12 sm:py-12 max-w-5xl mx-auto">

  <div class="flex flex-col sm:flex-row items-center justify-center gap-4 sm:gap-6 mb-6">
    <img src="{% static 'generator/eduPromptStudio_logo.png' %}" 
        alt="EduPrompt Studio Logo"
        class="h-16 w-16 object-contain rounded-md shadow-md bg-white p-1" />
    <h1 class="text-4xl sm:text-5xl font-extrabold tracking-tight leading-tight text-center sm:text-left">
        EduPrompt Studio
    </h1>
    </div>



  <p class="text-lg sm:text-xl font-medium text-center mb-2">

    Design better prompts with AI ‚Äì in seconds

  </p>

  <p class="text-sm sm:text-base text-center opacity-90">

    Craft research-based, classroom-ready prompts effortlessly

  </p>

</div>



</div>

<div class="mb-6 text-center">
  <a href="/help/" class="btn btn-outline btn-info">
    üìö User Guide & Help
  </a>
  <p class="text-sm text-gray-500 mt-2">
    New to EduPrompt Studio? Check out our comprehensive guide!
  </p>
</div>

      <form id="promptForm" onsubmit="handleSubmit(event)">

        

        <!-- QUICK START TEMPLATES -->

        <div class="mb-8 p-6 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border border-purple-200">

          <label for="template" class="block text-lg font-semibold mb-3 text-purple-800">

            ‚ö° Quick Start - Choose a template (optional)

          </label>

          <select id="template" name="template" class="select select-bordered w-full max-w-md bg-white">

            <option value="">Create from scratch</option>

            <optgroup label="üìö Lesson Planning">

              <option value="lesson_plan">Complete Lesson Plan</option>

              <option value="warm_up">Warm-up Activities</option>

              <option value="lesson_intro">Introduction to New Topic</option>

            </optgroup>

            <optgroup label="ü§î Critical Thinking">

              <option value="critical_questions">Critical Thinking Questions</option>

              <option value="problem_solving">Problem-Solving Activities</option>

              <option value="debates">Discussions & Debates</option>

            </optgroup>

            <optgroup label="üìù Practice & Activities">

              <option value="practice_exercises">Practice Exercises</option>

              <option value="group_activities">Group Activities</option>

              <option value="creative_writing">Creative Writing Prompts</option>

            </optgroup>

            <optgroup label="üéØ Assessment">

              <option value="quiz_assessment">Quiz & Assessment</option>

              <option value="rubrics">Create Rubrics</option>

              <option value="feedback">Provide Feedback</option>

            </optgroup>

            <optgroup label="üåü Differentiation">

              <option value="differentiated">Differentiated Activities</option>

              <option value="special_needs">Special Educational Needs</option>

              <option value="revision">Revision Activities</option>

            </optgroup>

          </select>

          <p class="text-sm text-purple-600 mt-2">üí° Select a template to auto-fill the form fields</p>

        </div>



        <!-- ROLE -->

        <div class="mb-6">

          <label for="role" class="block text-lg font-semibold mb-3 text-gray-700">

            ü§ñ What's your teaching role?

          </label>

          <div class="flex flex-col sm:flex-row gap-3">

            <select id="role" name="role" class="select select-bordered flex-1">

              <option value="">Select a role</option>

              <optgroup label="Education Levels">

                <option>Kindergarten teacher</option>

                <option>Elementary school teacher</option>

                <option>Middle school teacher</option>

                <option>High school teacher</option>

                <option>Special education teacher</option>

                <option>Language instructor</option>

              </optgroup>

              <optgroup label="Subject Specialists">

                <option>Math teacher</option>

                <option>Science teacher</option>

                <option>History teacher</option>

                <option>Literature teacher</option>

                <option>Art teacher</option>

                <option>PE teacher</option>

              </optgroup>

              <optgroup label="Other Roles">

                <option>Tutor</option>

                <option>Parent explaining to child</option>

                <option>Educational consultant</option>

                <option>Other</option>

              </optgroup>

            </select>

            <input id="roleOther" name="roleOther" type="text"

              placeholder="Please specify..."

              class="input input-bordered flex-1 hidden" />

          </div>

        </div>



        <!-- SUBJECT/TOPIC -->

        <div class="mb-6">

          <label for="subject" class="block text-lg font-semibold mb-3 text-gray-700">

            üìñ What subject content and learning objectives?

          </label>

          <input id="subject" name="subject" type="text"

            placeholder="e.g., Fractions - understanding equivalence and operations, World War II - analyzing causes and effects"

            class="input input-bordered w-full"

            required />

            <p class="text-sm text-gray-500 mt-1">Include both the subject area and specific learning goals</p>

        </div>



        <!-- TASK -->

        <div class="mb-6">

          <label for="task" class="block text-lg font-semibold mb-3 text-gray-700">

            üéØ What learning experience do you want to create?

          </label>

          <div class="flex flex-col sm:flex-row gap-3">

            <select id="task" name="task" class="select select-bordered flex-1">

              <option value="">Select a task</option>

              <optgroup label="Technology-Enhanced Content Creation">

                <option>Create a complete lesson plan with objectives</option>

                <option>Generate practice exercises with answers</option>

                <option>Design a quiz or assessment</option>

                <option>Create a project rubric</option>

                <option>Create vocabulary activities</option>

                <option>Provide feedback on student work</option>

              </optgroup>

              <optgroup label="Technology-Enhanced Pedagogy">

                <option>Design a warm-up activity</option>

                <option>Create an introduction to new topic</option>

                <option>Create gamified learning activities</option>

                <option>Design hands-on experiments</option>

                <option>Create storytelling activities</option>

                <option>Design real-world applications</option>

              </optgroup>

              <optgroup label="Comprehensive Learning Design">

                <option>Create critical thinking questions</option>

                <option>Design problem-solving scenarios</option>

                <option>Generate debate topics and arguments</option>

                <option>Create case studies for analysis</option>

                <option>Design differentiated activities</option>

                <option>Create activities for multiple intelligences</option>

                <option>Adapt content for special needs</option>

                <option>Generate extension activities</option>

                <option>Create revision activities</option>

                <option>Generate creative writing prompts</option>

              </optgroup>

              <optgroup label="Other">

                <option>Other</option>

              </optgroup>

            </select>

            <input id="taskOther" name="taskOther" type="text"

              placeholder="Please specify..."

              class="input input-bordered flex-1 hidden" />

          </div>

        </div>



        <!-- CONTEXT -->

        <div class="mb-6">

          <label for="context" class="block text-lg font-semibold mb-3 text-gray-700">

            üéì Who is this for? What's the context?

          </label>

          <div class="flex flex-col sm:flex-row gap-3">

            <select id="context" name="context" class="select select-bordered flex-1" required>

              <option value="">Select context</option>

              <optgroup label="Age Groups">

                <option>Preschool (ages 3-5)</option>

                <option>Primary students (ages 6-11)</option>

                <option>Lower secondary (ages 12-14)</option>

                <option>Upper secondary (ages 15-18)</option>

                <option>Adult learners</option>

              </optgroup>

              <optgroup label="Learning Environments">

                <option>Traditional classroom</option>

                <option>Online/remote learning</option>

                <option>Hybrid classroom</option>

                <option>Homeschool setting</option>

                <option>After-school program</option>

              </optgroup>

              <optgroup label="Special Considerations">

                <option>Mixed-ability classroom</option>

                <option>ESL/EFL learners</option>

                <option>Students with learning difficulties</option>

                <option>Gifted students</option>

                <option>Students preparing for exams</option>

              </optgroup>

              <optgroup label="Other">

                <option>Other</option>

              </optgroup>

            </select>

            <input id="contextOther" name="contextOther" type="text"

              placeholder="Please specify..."

              class="input input-bordered flex-1 hidden" />

          </div>

        </div>



        <!-- METHODOLOGY -->

        <div class="mb-6">

          <label for="methodology" class="block text-lg font-semibold mb-3 text-gray-700">

            üß† What teaching approach supports your learning goals?

          </label>

          <div class="flex flex-col sm:flex-row gap-3">

            <select id="methodology" name="methodology" class="select select-bordered flex-1">

              <option value="">Select methodology</option>

              <optgroup label="AI Supports Direct Teaching">

                <option>Teacher explains, AI provides examples and practice (Direct Instruction)</option>

                <option>Teacher demonstrates, AI offers step-by-step guidance (Modeling & Demonstration)</option>

                <option>Teacher presents, AI reinforces with interactive content (Lecture-based with Tech Enhancement)</option>

              </optgroup>

              <optgroup label="AI Enables Student Discovery">

                <option>Students explore with AI as research assistant (Inquiry-based Learning)</option>

                <option>Students solve problems with AI hints and scaffolding (Problem-based Learning)</option>

                <option>Students create projects with AI collaboration tools (Project-based Learning)</option>

                <option>Students work in groups with AI facilitation (Collaborative Learning)</option>

              </optgroup>

              <optgroup label="AI Adapts to Individual Needs">

                <option>AI provides different paths for different learners (Differentiated Instruction)</option>

                <option>AI adjusts difficulty based on student progress (Adaptive Learning)</option>

                <option>AI offers multiple ways to show understanding (Multiple Intelligences)</option>

                <option>AI gives personalized support and encouragement (Scaffolding)</option>

              </optgroup>

              <optgroup label="AI Enhances Assessment">

                <option>AI provides ongoing feedback during learning (Formative Assessment)</option>

                <option>AI helps students reflect on their progress (Self-assessment & Reflection)</option>

                <option>Students assess each other with AI guidance (Peer Assessment)</option>

                <option>Other</option>

              </optgroup>

            </select>

            <input id="methodologyOther" name="methodologyOther" type="text"

              placeholder="Please specify..."

              class="input input-bordered flex-1 hidden" />

          </div>

        </div>



        <!-- TONE -->

        <div class="mb-6">

          <label for="tone" class="block text-lg font-semibold mb-3 text-gray-700">

            üé≠ What tone should the AI adopt?

          </label>

          <div class="flex flex-col sm:flex-row gap-3">

            <select id="tone" name="tone" class="select select-bordered flex-1">

              <option value="">Select tone</option>

              <optgroup label="Supportive">

                <option>Encouraging and supportive</option>

                <option>Patient and gentle</option>

                <option>Motivational and inspiring</option>

                <option>Nurturing and caring</option>

              </optgroup>

              <optgroup label="Engaging">

                <option>Friendly and conversational</option>

                <option>Humorous and playful</option>

                <option>Enthusiastic and energetic</option>

                <option>Curious and exploratory</option>

              </optgroup>

              <optgroup label="Professional">

                <option>Academic and precise</option>

                <option>Neutral and objective</option>

                <option>Formal and structured</option>

                <option>Clear and direct</option>

              </optgroup>

              <optgroup label="Casual">

                <option>Informal and casual</option>

                <option>Relaxed and approachable</option>

                <option>Other</option>

              </optgroup>

            </select>

            <input id="toneOther" name="toneOther" type="text"

              placeholder="Please specify..."

              class="input input-bordered flex-1 hidden" />

          </div>

        </div>



        <!-- EXAMPLES / EXCLUSIONS -->

        <div class="mb-8">

          <label for="examples" class="block text-lg font-semibold mb-3 text-gray-700">

            üìã Additional Guidelines (Optional)

          </label>

          <div class="grid md:grid-cols-2 gap-4">

            <div>

              <label class="block text-sm font-medium mb-2 text-green-700">‚úÖ Include:</label>

              <textarea id="include" name="include"

                placeholder="e.g., Real-life examples, visual aids, step-by-step instructions"

                class="textarea textarea-bordered w-full h-24 border-green-300 focus:border-green-500"></textarea>

            </div>

            <div>

              <label class="block text-sm font-medium mb-2 text-red-700">‚ùå Avoid:</label>

              <textarea id="exclude" name="exclude"

                placeholder="e.g., Complex terminology, abstract concepts, lengthy explanations"

                class="textarea textarea-bordered w-full h-24 border-red-300 focus:border-red-500"></textarea>

            </div>

          </div>

          <p class="text-sm text-gray-500 mt-2">üí° These fields are optional but help create more targeted prompts</p>

        </div>

        <!-- ENHANCEMENT OPTIONS -->

        <div class="mb-6 p-4 bg-yellow-50 rounded-lg border border-yellow-200">

          <h4 class="font-semibold text-yellow-800 mb-3">üéì Prompt Enhancement Options:</h4>

          <div class="space-y-2">

            <label class="flex items-center">

              <input type="radio" name="enhancement" value="enhanced" class="mr-2" checked>

              <span class="text-sm">

                <strong>Generate with learning theory enhancements</strong> (recommended)

                <br><em class="text-gray-600">Includes TPACK integration, UDL principles, and Bloom's taxonomy</em>

              </span>

            </label>

            <label class="flex items-center">

              <input type="radio" name="enhancement" value="basic" class="mr-2">

              <span class="text-sm">

                <strong>Generate exact prompt as specified</strong>

                <br><em class="text-gray-600">No additional theoretical enhancements</em>

              </span>

            </label>

          </div>

        </div>

        <!-- SUBMIT BUTTON -->

        <div class="text-center">

          <button type="button" id="generateBtn" onclick="generateWithGemini()" 

                  class="btn btn-primary text-white px-8 py-3 rounded-lg bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-lg font-semibold shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200">

            üöÄ Generate Prompt

          </button>

        </div>

        

        <!-- LOADING INDICATOR -->

        <div id="loadingIndicator" class="text-center mt-8 hidden">

          <div class="flex flex-col items-center justify-center">

            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mb-4"></div>

            <p class="text-gray-600 font-medium">Generating your prompt‚Ä¶ Please wait.</p>

            <p class="text-sm text-gray-500 mt-1">This may take up to 15 seconds</p>

          </div>

        </div>

        

        <!-- PROMPT OUTPUT -->

        <div id="promptContainer" class="mt-8 p-6 bg-gradient-to-r from-green-50 to-blue-50 rounded-lg shadow-md border border-green-200" style="display: none;">

          <h2 class="text-xl font-semibold mb-4 text-green-800">‚ú® Your Generated Prompt:</h2>

          <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm">

            <textarea id="outputPrompt" class="w-full h-48 p-3 text-gray-800 font-mono text-sm border border-gray-300 rounded resize-none focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>

          </div>

          <div class="mt-4 flex items-center justify-center gap-4">

            <button type="button" onclick="copyToClipboard()" class="btn btn-sm btn-outline btn-success">

              üìã Copy to Clipboard

            </button>

            <button type="button" onclick="showPromptImprovements()" class="btn btn-sm btn-outline btn-info">

              ‚ö° Improve This Prompt

            </button>

          </div>

        </div>



      </form>

    </div>

  </div>



  <!-- Prompt Improvements Modal -->

  <div id="promptImprovementsModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">

    <div class="bg-white rounded-lg p-6 max-w-2xl mx-4 shadow-2xl transform transition-all duration-300 scale-95 max-h-[90vh] overflow-y-auto">

      <div class="flex justify-between items-center mb-4">

        <h3 class="text-xl font-semibold text-gray-800">‚ö° How to Improve This Prompt</h3>

        <button onclick="closePromptImprovementsModal()" class="text-gray-500 hover:text-gray-700">

          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">

            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>

          </svg>

        </button>

      </div>

      

      <div id="theoryLoadingIndicator" class="text-center py-8">

        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"></div>

        <p class="text-gray-600">Analyzing prompt improvements...</p>

      </div>

      

      <div id="theoryContent" class="hidden">

                

        <div class="bg-green-50 p-4 rounded-lg border border-green-200 mb-4">

          <h4 class="font-semibold text-green-800 mb-2">üéØ Your Prompt Configuration:</h4>

          <div id="promptConfiguration" class="text-sm text-gray-600"></div>

        </div>

        

        <div class="bg-blue-50 p-4 rounded-lg border border-blue-200 mb-4">

          <h4 class="font-semibold text-blue-800 mb-2">‚ö° Choose Improvements to Apply:</h4>

          <div id="improvementsList" class="space-y-3">

            <!-- Checkboxes will be dynamically added here -->

          </div>

          <div class="mt-4 text-center">

            <button type="button" onclick="applySelectedImprovements()" class="btn btn-sm btn-primary">

              üöÄ Apply Selected Improvements

            </button>

          </div>

        </div>

      </div>

      

      <div class="mt-6 text-center">

        <button onclick="closePromptImprovementsModal()" class="btn btn-sm btn-primary">

          Got it!

        </button>

      </div>

    </div>

  </div>



  <!-- Confirmation Modal -->

  <div id="confirmationModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">

    <div class="bg-white rounded-lg p-6 max-w-sm mx-4 shadow-2xl transform transition-all duration-300 scale-95">

      <div class="text-center">

        <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">

          <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">

            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>

          </svg>

        </div>

        <h3 class="text-lg font-semibold text-gray-800 mb-2">Prompt Copied!</h3>

        <p class="text-gray-600 mb-4">Your AI prompt has been successfully copied to the clipboard.</p>

        <button onclick="closeConfirmationModal()" class="btn btn-sm btn-primary">

          Got it!

        </button>

      </div>

    </div>

  </div>



  <script>

    // Template definitions

    const templates = {

          lesson_plan: {

            role: "High school teacher",

            task: "Create a complete lesson plan with objectives",

            context: "Upper secondary (ages 15-18)",

            methodology: "Teacher explains, AI provides examples and practice (Direct Instruction)",

            tone: "Academic and precise",

            include: "Learning objectives, assessment methods, differentiation strategies, timing for each activity",

            exclude: "Overly complex activities, unrealistic time expectations"

          },

          warm_up: {

            role: "Elementary school teacher",

            task: "Design a warm-up activity",

            context: "Primary students (ages 6-11)",

            methodology: "Students work in groups with AI facilitation (Collaborative Learning)",

            tone: "Enthusiastic and energetic",

            include: "Interactive elements, 5-10 minute duration, connection to previous learning",

            exclude: "Lengthy explanations, sedentary activities"

          },

          lesson_intro: {

            role: "Middle school teacher",

            task: "Create an introduction to new topic",

            context: "Lower secondary (ages 12-14)",

            methodology: "Students explore with AI as research assistant (Inquiry-based Learning)",

            tone: "Curious and exploratory",

            include: "Hook activity, prior knowledge activation, learning objectives preview",

            exclude: "Information overload, lengthy explanations at the start"

          },

          critical_questions: {

            role: "Middle school teacher",

            task: "Create critical thinking questions",

            context: "Lower secondary (ages 12-14)",

            methodology: "Students explore with AI as research assistant (Inquiry-based Learning)",

            tone: "Curious and exploratory",

            include: "Questions from different cognitive levels, open-ended questions",

            exclude: "Yes/no questions, factual recall only"

          },

          problem_solving: {

            role: "High school teacher",

            task: "Design problem-solving scenarios",

            context: "Upper secondary (ages 15-18)",

            methodology: "Students solve problems with AI hints and scaffolding (Problem-based Learning)",

            tone: "Encouraging and supportive",

            include: "Real-world scenarios, step-by-step thinking process, collaborative elements",

            exclude: "Abstract problems without context, overwhelming complexity"

          },

          debates: {

            role: "High school teacher",

            task: "Generate debate topics and arguments",

            context: "Upper secondary (ages 15-18)",

            methodology: "Students work in groups with AI facilitation (Collaborative Learning)",

            tone: "Neutral and objective",

            include: "Balanced perspectives, evidence-based arguments, structured format",

            exclude: "Controversial personal topics, one-sided arguments"

          },

          practice_exercises: {

            role: "Math teacher",

            task: "Generate practice exercises with answers",

            context: "Mixed-ability classroom",

            methodology: "AI gives personalized support and encouragement (Scaffolding)",

            tone: "Encouraging and supportive",

            include: "Varying difficulty levels, step-by-step solutions, real-world applications",

            exclude: "Repetitive drill exercises, abstract examples only"

          },

          group_activities: {

            role: "High school teacher",

            task: "Students work in groups with AI facilitation (Collaborative Learning)",

            context: "Upper secondary (ages 15-18)",

            methodology: "Students work in groups with AI facilitation (Collaborative Learning)",

            tone: "Friendly and conversational",

            include: "Clear roles for each member, specific objectives, time management",

            exclude: "Vague instructions, unequal participation opportunities"

          },

          creative_writing: {

            role: "Literature teacher",

            task: "Generate creative writing prompts",

            context: "Lower secondary (ages 12-14)",

            methodology: "Students create projects with AI collaboration tools (Project-based Learning)",

            tone: "Motivational and inspiring",

            include: "Diverse themes, sensory details, character development prompts",

            exclude: "Overly complex themes, adult topics"

          },

          quiz_assessment: {

            role: "Science teacher",

            task: "Design a quiz or assessment",

            context: "Upper secondary (ages 15-18)",

            methodology: "AI provides ongoing feedback during learning (Formative Assessment)",

            tone: "Clear and direct",

            include: "Multiple question types, clear rubrics, immediate feedback",

            exclude: "Trick questions, ambiguous wording"

          },

          rubrics: {

            role: "Elementary school teacher",

            task: "Create a project rubric",

            context: "Primary students (ages 6-11)",

            methodology: "AI helps students reflect on their progress (Self-assessment & Reflection)",

            tone: "Clear and direct",

            include: "Age-appropriate criteria, visual elements, student-friendly language",

            exclude: "Complex terminology, too many criteria"

          },

          feedback: {

            role: "Elementary school teacher",

            task: "Provide feedback on student work",

            context: "Primary students (ages 6-11)",

            methodology: "AI provides ongoing feedback during learning (Formative Assessment)",

            tone: "Encouraging and supportive",

            include: "Specific examples, growth-focused language, actionable next steps",

            exclude: "Harsh criticism, vague comments, comparison to other students"

          },

          differentiated: {

            role: "Special education teacher",

            task: "Design differentiated activities",

            context: "Students with learning difficulties",

            methodology: "AI provides different paths for different learners (Differentiated Instruction)",

            tone: "Patient and gentle",

            include: "Multiple learning styles, scaffolding options, assistive technology",

            exclude: "One-size-fits-all approaches, overwhelming complexity"

          },

          special_needs: {

            role: "Special education teacher",

            task: "Adapt content for special needs",

            context: "Students with learning difficulties",

            methodology: "AI offers multiple ways to show understanding (Multiple Intelligences)",

            tone: "Patient and gentle",

            include: "Visual supports, sensory breaks, simplified instructions, assistive technology",

            exclude: "Complex multi-step tasks, time pressure, abstract concepts without support"

          },

          revision: {

            role: "High school teacher",

            task: "Create revision activities",

            context: "Students preparing for exams",

            methodology: "AI adjusts difficulty based on student progress (Adaptive Learning)",

            tone: "Motivational and inspiring",

            include: "Variety of review methods, self-testing opportunities, key concept summaries",

            exclude: "Passive reading only, information overload"

          }

        };

    // Handle template selection

    document.getElementById('template').addEventListener('change', function() {

      const selectedTemplate = this.value;

      if (selectedTemplate && templates[selectedTemplate]) {

        const template = templates[selectedTemplate];

        

        // Fill form fields

        document.getElementById('role').value = template.role;

        document.getElementById('task').value = template.task;

        document.getElementById('context').value = template.context;

        document.getElementById('methodology').value = template.methodology;

        document.getElementById('tone').value = template.tone;

        document.getElementById('include').value = template.include;

        document.getElementById('exclude').value = template.exclude;

        

        // Show visual feedback

        this.classList.add('bg-green-50', 'border-green-300');

        setTimeout(() => {

          this.classList.remove('bg-green-50', 'border-green-300');

        }, 2000);

      } else {

        // Clear form if "Create from scratch" is selected

        document.getElementById('role').value = '';

        document.getElementById('task').value = '';

        document.getElementById('context').value = '';

        document.getElementById('methodology').value = '';

        document.getElementById('tone').value = '';

        document.getElementById('include').value = '';

        document.getElementById('exclude').value = '';

      }

    });



    // Toggle "Other" fields

    function toggleOther(selectId, inputId) {

      const select = document.getElementById(selectId);

      const input = document.getElementById(inputId);

      select.addEventListener("change", () => {

        input.classList.toggle("hidden", !select.value.includes("Other"));

      });

    }



    toggleOther("role", "roleOther");

    toggleOther("task", "taskOther");

    toggleOther("context", "contextOther");

    toggleOther("methodology", "methodologyOther");

    toggleOther("tone", "toneOther");



    // Show confirmation modal

    function showConfirmationModal() {

      const modal = document.getElementById('confirmationModal');

      modal.classList.remove('hidden');

      // Add animation class

      setTimeout(() => {

        modal.querySelector('.transform').classList.remove('scale-95');

        modal.querySelector('.transform').classList.add('scale-100');

      }, 10);

    }



    // Close confirmation modal

    function closeConfirmationModal() {

      const modal = document.getElementById('confirmationModal');

      modal.querySelector('.transform').classList.remove('scale-100');

      modal.querySelector('.transform').classList.add('scale-95');

      setTimeout(() => {

        modal.classList.add('hidden');

      }, 300);

    }



    // Copy to clipboard function with confirmation

    function copyToClipboard() {
  const promptText = document.getElementById('outputPrompt').textContent;
  navigator.clipboard.writeText(promptText).then(() => {
    // Track copy success
    trackCopySuccess();
    showConfirmationModal();
  }).catch(err => {
    console.error('Failed to copy text: ', err);
    alert('Prompt copied to clipboard!');
  });
}

// Add this new function
async function trackCopySuccess() {
  try {
    await fetch("/track-copy/", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "X-CSRFToken": getCSRFToken(),
      },
      credentials: "same-origin"
    });
  } catch (error) {
    console.log('Copy tracking failed:', error);
  }
}



    // Close modal when clicking outside

    document.getElementById('confirmationModal').addEventListener('click', function(e) {

      if (e.target === this) {

        closeConfirmationModal();

      }

    });



    // Store current form data for improvements analysis

    let currentFormData = {};



    // Generate prompt function

    async function generateWithGemini() {

      const loadingIndicator = document.getElementById("loadingIndicator");

      const promptContainer = document.getElementById("promptContainer");

      const generateBtn = document.getElementById("generateBtn");

      

      loadingIndicator.classList.remove("hidden");

      promptContainer.style.display = "none";

      generateBtn.disabled = true;

      generateBtn.textContent = "Generating...";

      generateBtn.classList.add("opacity-50", "cursor-not-allowed");



      // Get form values

      const role = document.getElementById("role").value;

      const roleOther = document.getElementById("roleOther").value;

      const subject = document.getElementById("subject").value;

      const task = document.getElementById("task").value;

      const taskOther = document.getElementById("taskOther").value;

      const context = document.getElementById("context").value;

      const contextOther = document.getElementById("contextOther").value;

      const methodology = document.getElementById("methodology").value;

      const methodologyOther = document.getElementById("methodologyOther").value;

      const tone = document.getElementById("tone").value;

      const toneOther = document.getElementById("toneOther").value;

      const include = document.getElementById("include").value;

      const exclude = document.getElementById("exclude").value;



      // Determine final values

      const finalRole = role === "Other" ? roleOther : role;

      const finalTask = task === "Other" ? taskOther : task;

      const finalContext = context === "Other" ? contextOther : context;

      const finalMethodology = methodology === "Other" ? methodologyOther : methodology;

      const finalTone = tone.includes("Other") ? toneOther : tone;



      // Store form data for improvements analysis

      currentFormData = {

        role: finalRole,

        subject: subject,

        task: finalTask,

        context: finalContext,

        methodology: finalMethodology,

        tone: finalTone,

        include: include,

        exclude: exclude

      };



      // Build examples section

      let examplesSection = '';

      if (include || exclude) {

        examplesSection = '\n\nAdditional Guidelines:';

        if (include) examplesSection += `\n- Include: ${include}`;

        if (exclude) examplesSection += `\n- Avoid: ${exclude}`;

      }



      // Create user input for Gemini

      const userInput = `

Create a clear, professional AI prompt using EXACTLY these components. Do not add extra elements or creative flourishes.



Components to connect:

- Role: ${finalRole}

- Subject: ${subject}

- Task: ${finalTask}

- Context: ${finalContext}

- Methodology: ${finalMethodology}

- Tone: ${finalTone}${examplesSection}



Instructions:

1. Create a single, coherent prompt that combines these elements naturally

2. Use proper English grammar and clear sentence structure

3. Do NOT add elements not specified above

4. Make it ready to copy-paste into any AI chatbot

5. Start with "You are..." and include all the specified components

6. Keep it professional and focused on the educational task

      `;



      try {

        // Make request to Django backend

        const response = await fetch("/generate/", {

          method: "POST",

          headers: {

            "Content-Type": "application/json",

            "X-CSRFToken": getCSRFToken(),

          },

          credentials: "same-origin", 

          // Get enhancement preference

          body: JSON.stringify({ 

            prompt: userInput,

            enhancement: (function() {

              const el = document.querySelector('input[name="enhancement"]:checked');

              return el ? el.value : 'enhanced';

            })(),

            role: finalRole,

            task: finalTask,

            context: finalContext,

            methodology: finalMethodology,

            subject: subject,

            tone: finalTone

          })

        });



        const data = await response.json();

        const outputDiv = document.getElementById("outputPrompt");



        if (data.response) {

          outputDiv.textContent = data.response;

          promptContainer.style.display = "block";

        } else {

          outputDiv.textContent = "‚ùå Sorry, no prompt was generated.";

          promptContainer.style.display = "block";

        }

        

      } catch (error) {

        console.error("‚ùå Network or unexpected error:", error);

        const outputDiv = document.getElementById("outputPrompt");

        outputDiv.textContent = "‚ùå Network or unexpected error: " + error.message;

        promptContainer.style.display = "block";

      } finally {

        loadingIndicator.classList.add("hidden");

        generateBtn.disabled = false;

        generateBtn.textContent = "üöÄ Generate Prompt";

        generateBtn.classList.remove("opacity-50", "cursor-not-allowed");

      }

    }



    // Show prompt improvements modal

    async function showPromptImprovements() {

      const modal = document.getElementById('promptImprovementsModal');

      const loadingIndicator = document.getElementById('theoryLoadingIndicator');

      const theoryContent = document.getElementById('theoryContent');

      

      modal.classList.remove('hidden');

      setTimeout(() => {

        modal.querySelector('.transform').classList.remove('scale-95');

        modal.querySelector('.transform').classList.add('scale-100');

      }, 10);

      

      loadingIndicator.classList.remove('hidden');

      theoryContent.classList.add('hidden');

      

      // Display current configuration

      const configDiv = document.getElementById('promptConfiguration');

      configDiv.innerHTML = `

        <div class="grid grid-cols-2 gap-2 text-sm">

          <div><strong>Role:</strong> ${currentFormData.role || 'Not specified'}</div>

          <div><strong>Subject:</strong> ${currentFormData.subject || 'Not specified'}</div>

          <div><strong>Task:</strong> ${currentFormData.task || 'Not specified'}</div>

          <div><strong>Context:</strong> ${currentFormData.context || 'Not specified'}</div>

          <div><strong>Methodology:</strong> ${currentFormData.methodology || 'Not specified'}</div>

          <div><strong>Tone:</strong> ${currentFormData.tone || 'Not specified'}</div>

        </div>

      `;

      

      // Create prompt improvement analysis prompt

      const improvementPrompt = `

You are a prompt engineering expert for educational AI prompts. Based on this prompt configuration:



- Role: ${currentFormData.role}

- Subject: ${currentFormData.subject}

- Task: ${currentFormData.task}

- Context: ${currentFormData.context}

- Methodology: ${currentFormData.methodology}

- Tone: ${currentFormData.tone}



Please provide:

1. 3-4 specific improvements the user could add to their prompt to make it more effective

2. 2-3 advanced variations they could try for different situations



Format your response as JSON:

{

  "prompt_improvements": "Your specific suggestions here...",

  "prompt_variations": "Your variation ideas here..."

}



Focus on practical additions like: asking for specific formats, requesting differentiation levels, adding assessment criteria, including time constraints, etc.

      `;

      

      try {

        // Make request to Django backend for improvement analysis

        const response = await fetch("/generate/", {

          method: "POST",

          headers: {

            "Content-Type": "application/json",

            "X-CSRFToken": getCSRFToken(),

          },

          credentials: "same-origin", 

          body: JSON.stringify({ prompt: improvementPrompt })

        });



        const data = await response.json();

        

        if (data.response) {

          try {

            // First try to parse as direct JSON

            const mainData = JSON.parse(data.response);

            

            // Format improvements text

            let improvements = mainData.prompt_improvements;

            let variations = mainData.prompt_variations;

            

            // Convert **text** to <strong>text</strong>

            improvements = improvements.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');

            variations = variations.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');

            

                        // Parse improvements into individual items and create checkboxes

            const improvementsList = document.getElementById('improvementsList');

            let improvementsText = mainData.prompt_improvements;



            // Convert **text** to <strong>text</strong> first

            improvementsText = improvementsText.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');



            // Split improvements by numbered list (1., 2., 3.)

            const improvementItems = improvementsText.split(/(?=\d+\.\s+)/).filter(item => item.trim());



            // Create checkboxes for each improvement

            improvementsList.innerHTML = '';

            if (improvementItems.length > 0) {

                improvementItems.slice(0, 3).forEach((improvement, index) => {

                if (improvement.trim()) {

                  const checkboxHtml = `

                    <div class="flex items-start space-x-3">

                      <input type="checkbox" id="improvement${index}" class="mt-1" value="${improvement.trim()}">

                      <label for="improvement${index}" class="text-sm text-gray-700 cursor-pointer">

                        ${improvement.trim()}

                      </label>

                    </div>

                  `;

                  improvementsList.innerHTML += checkboxHtml;

                }

              });

            } else {

              improvementsList.innerHTML = '<p class="text-gray-600">No improvements available at this time.</p>';

            }



            // Split improvements by numbered list (1., 2., 3.)

            const individualImprovements = improvementsText.split(/\d+\.\s+/).filter(item => item.trim());



            // Create checkboxes for each improvement

            improvementsList.innerHTML = '';

            individualImprovements.slice(0, 3).forEach((improvement, index) => {

              const checkboxHtml = `

                <div class="flex items-start space-x-3">

                  <input type="checkbox" id="improvement${index}" class="mt-1 form-checkbox" value="${improvement.trim()}">

                  <label for="improvement${index}" class="text-sm text-gray-700 cursor-pointer">

                    ${improvement.trim().replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')}

                  </label>

                </div>

              `;

              improvementsList.innerHTML += checkboxHtml;

            });

            

          } catch (jsonError) {

            // If JSON parsing fails, use raw response with basic formatting

            let cleanText = data.response.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');

            document.getElementById('promptImprovements').innerHTML = cleanText;

            document.getElementById('promptVariations').innerHTML = "Try experimenting with different specificity levels and output formats.";

          }

        } else {

          document.getElementById('promptImprovements').innerHTML = "Unable to analyze prompt improvements at this time.";

          document.getElementById('promptVariations').innerHTML = "Consider adding more specific requirements or constraints to your prompt.";

        }

        

      } catch (error) {

        console.error("Improvement analysis error:", error);

        document.getElementById('promptImprovements').innerHTML = "Unable to analyze prompt improvements at this time.";

        document.getElementById('promptVariations').innerHTML = "Consider adding more specific requirements or constraints to your prompt.";

      } finally {

        loadingIndicator.classList.add('hidden');

        theoryContent.classList.remove('hidden');

      }

    }

    // Apply selected improvements to the original prompt

async function applySelectedImprovements() {

  const checkboxes = document.querySelectorAll('#improvementsList input[type="checkbox"]:checked');

  

  if (checkboxes.length === 0) {

    alert('Please select at least one improvement to apply.');

    return;

  }

  

  // Get selected improvements

  const selectedImprovements = Array.from(checkboxes).map(cb => cb.value);

  const originalPrompt = document.getElementById('outputPrompt').textContent;

  

  // Create enhancement prompt for Gemini

  const enhancementPrompt = `

Take this original prompt and enhance it by incorporating these specific improvements:



Original prompt:

${originalPrompt}



Improvements to incorporate:

${selectedImprovements.map((imp, index) => `- ${imp}`).join('\n')}



Return only the improved prompt, ready to use. Do not include explanations or additional text.

  `;

  

  try {

    // Show loading in the modal

    const improvementsList = document.getElementById('improvementsList');

    improvementsList.innerHTML = '<div class="text-center py-4"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div><p class="mt-2 text-gray-600">Applying improvements...</p></div>';

    

    // Call Gemini API

    const response = await fetch("/generate/", {

      method: "POST",

      headers: {

        "Content-Type": "application/json",

        "X-CSRFToken": getCSRFToken(),

      },

      credentials: "same-origin", 

      body: JSON.stringify({ prompt: enhancementPrompt })

    });



    const data = await response.json();

    

    if (data.response) {

      // Update the main prompt textarea with improved version

      document.getElementById('outputPrompt').textContent = data.response;

      

      // Close the improvements modal

      closePromptImprovementsModal();

      

      // Show success message

      alert('Prompt improved successfully! You can now edit it further if needed.');

    } else {

      throw new Error('No response received');

    }

    

  } catch (error) {

    console.error('Error applying improvements:', error);

    alert('Error applying improvements. Please try again.');

    

    // Restore the improvements list on error

    showPromptImprovements();

  }

}

    // Close prompt improvements modal

    function closePromptImprovementsModal() {

      const modal = document.getElementById('promptImprovementsModal');

      modal.querySelector('.transform').classList.remove('scale-100');

      modal.querySelector('.transform').classList.add('scale-95');

      setTimeout(() => {

        modal.classList.add('hidden');

      }, 300);

    }



    // Close modal when clicking outside

    document.getElementById('promptImprovementsModal').addEventListener('click', function(e) {

      if (e.target === this) {

        closePromptImprovementsModal();

      }

    });



    // CSRF token function

    function getCSRFToken() {

      const name = "csrftoken";

      const cookies = document.cookie.split(';');

      for (let cookie of cookies) {

        const trimmed = cookie.trim();

        if (trimmed.startsWith(name + '=')) {

          return decodeURIComponent(trimmed.substring(name.length + 1));

        }

      }

      return '';

    }

  </script>

</body>

</html>